# Plan to Remove Conda Dependency from RAUX Installer

## Goal
Modify the RAUX installer to eliminate the conda dependency and make it use its own Python 3.11 installation, similar to how GAIA's installer works.

## Analysis of Current System
- RAUX installer currently depends on conda for Python isolation
- GAIA installer uses Python 3.10.9, but RAUX requires Python 3.11
- Installer.nsi already has code to download Python 3.11.8 for RAUX, but still uses conda for package management
- RAUX installation process is handled by `raux_installer.py` which calls `install.py`. `install.py` is part of this project, but is independently used by the exe generated by `Installer-UX.nsi`
- Launch scripts (`launch_raux.ps1` and `launch_raux.cmd`) assume conda environment
- GitHub workflows (`build-release.yml` and `build-pr.yml`) build packages and installers that may rely on conda

## Current Progress

- [x] Modified `install.py` (in our local repository):
  - [x] Removed conda environment creation code
  - [x] Updated to use standalone Python environment 
  - [x] Updated package installation to use pip directly
  - [x] Updated shortcut creation to use standalone Python paths

- [x] Updated launcher scripts:
  - [x] Modified `launch_raux.ps1` to use Python 3.11.8 path directly
  - [x] Modified `launch_raux.cmd` to use Python 3.11.8 path directly
  - [x] Removed all conda activation commands
  - [x] Added proper error handling for missing Python installation

- [x] Updated `raux_installer.py`:
  - [x] Removed all remaining conda references
  - [x] Removed line: `"install.py will handle its own conda environment setup"`
  - [x] Updated directory paths to use `python` folder instead of `raux_env`
  - [x] Updated final installation instructions to use standalone Python
  - [x] Added proper Python version constant (3.11.8)
  - [x] Using standalone Python path when calling `install.py`

- [x] Updated `Installer.nsi`:
  - [x] Added proper Python version and directory constants
  - [x] Added Python embedded package download and setup
  - [x] Removed all conda installation steps
  - [x] Updated error handling to reflect Python-only installation
  - [x] Ensured consistent Python path usage: `%LOCALAPPDATA%\RAUX\python\python.exe`
  - [x] Added pip and required packages installation

## Testing Results (May 1, 2025)

- [!] Installation testing revealed several issues with our implementation:
  - Modified `install.py` works as expected when run directly with standalone Python
  - The Python executable path in launcher scripts points to `%LOCALAPPDATA%\RAUX\python\python.exe`
  - Need to verify that `raux_installer.py` changes correctly create Python in this location
  - Need to test the updated `Installer.nsi` changes

## Remaining Tasks

- [ ] Ensure path consistency across all components:
  - [ ] Test all files to verify they reference the same Python path: `%LOCALAPPDATA%\RAUX\python\python.exe`
  - [ ] Run a complete installation test to verify Python setup and path usage
  - [ ] Verify no remaining conda references exist in any files

## Test Plan

1. Fresh Installation Testing:
   - Test on a system without conda installed
   - Verify Python is installed to the correct path
   - Verify launcher scripts can find Python and start RAUX
   - Check installation logs for any conda-related messages

2. Upgrade Testing:
   - Test upgrading from conda-based installation
   - Verify old environment is properly handled
   - Ensure launcher scripts correctly use new Python location

3. Package Distribution:
   - Verify GitHub workflows correctly package the updated versions of all files
   - Test the downloadable package to ensure it contains no conda dependencies

## Implementation Approach (Revised)

1. **Comprehensive Testing**: 
   - Run full installation tests to verify all components work together
   - Check all Python path references are consistent
   - Verify no conda dependencies remain

2. **Build Process Integration**:
   - Ensure GitHub workflows build and package the updated files correctly
   - Add validation checks to prevent conda-dependent code from being released

## References
- The "run_raux_installer" section in Installer.nsi already has code for downloading Python 3.11.8
- We can adapt GAIA's approach of using pip with embedded Python for all package management
- GitHub Actions workflows (.github/workflows/) manage the build and packaging process
